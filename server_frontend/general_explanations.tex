\section{General explanations}
% 
This application is, as explained above, a server web application used to 
communicate with the web browser. However, the application really has two 
roles, which are very different from each other. We will here give a brief 
description of how these two roles are handled by the application.

A global overview of the execution of the program seen from the frontend 
application can be found in figure~\ref{fig:frontend-sequence-diag}.
\input{server_frontend/sequence_diagram}

During the login phase, the application just acts as a normal web 
application. The client sends its credentials through an HTTP request,
with some additional information, such as the size of the web browser 
window. The application checks the credentials of the client, and 
just sends back an error in case they did not match the UNIX/Linux 
credentials. If the credentials were correct, two actions happen 
simultaneously. 
\begin{itemize}
\item The application launches a process of the backend 
  application with the user id of the user connecting.
%  
  When the backend application initializes, it sends a message to 
  the web application to register itself, sending a unique identifier 
  in order for both application to communicate together. 
%
  This process usually ends up a little faster than the websocket connection and 
  the first messages received from the backend application are queued until 
  the websocket connection is opened. This choice have been made over waiting %Are you writing now?
\item It also sends the JS application for the web browser through the HTTP 
  response with a secret token to authenticate the client. 
%  
  When the web browser receives this response, it initializes a websocket 
  connection with the application, sending the secret token with it. 
%
  The application checks for the authenticity of the token, and if the token is valid, 
  the application accepts the websocket connection and starts transferring the messages 
  that have been queued while waiting for the websocket connection to open.
\end{itemize}

After the having been initialized, the system enters in its \emph{main loop} as shown 
in figure~\ref{fig:frontend-sequence-diag}. The backend application transfers the 
requests received from X clients to the frontend application, which then transfer 
them to the web browser. When a reply or an event is generated by the browser, 
it is first sent to the frontend application which then send the message to the backend 
application for it to inform the X client accordingly.
